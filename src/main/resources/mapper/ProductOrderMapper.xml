<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.lotteon.mapper.ProductOrderMapper">
    
    <select id="selectProductOrders" resultType="kr.co.lotteon.dto.product.ProductOrderDTO">
        SELECT a.*, b.*, c.prodCate1, c.prodCate2, c.company, c.thumb1, c.prodName
        FROM lo_product_order_item AS a
            JOIN lo_product_order AS b ON a.ordNo = b.ordNo
            JOIN lo_product AS c ON a.prodNo = c.prodNo
        WHERE b.ordUid = #{ordUid}
        AND b.ordDate >= DATE_SUB(NOW(), INTERVAL 1 YEAR)
        ORDER BY a.ordNo DESC
        LIMIT #{startNum}, 10
    </select>
    <select id="selectProductOrdersDate" resultType="kr.co.lotteon.dto.product.ProductOrderDTO">
        SELECT a.*, b.*, c.prodCate1, c.prodCate2, c.company, c.thumb1, c.prodName
        FROM lo_product_order_item AS a
                 JOIN lo_product_order AS b ON a.ordNo = b.ordNo
                 JOIN lo_product AS c ON a.prodNo = c.prodNo
        WHERE b.ordUid = #{ordUid} AND b.ordDate BETWEEN DATE(#{beginDate})
        AND DATE(#{endDate})
        AND b.ordDate >= DATE_SUB(NOW(), INTERVAL 1 YEAR)
        ORDER BY a.ordNo DESC
        LIMIT #{startNum}, 10
    </select>
    
    
    
    <insert id="insertOrder" useGeneratedKeys="true" keyProperty="ordNo">
        insert into `lo_product_order` (`ordUid`,`ordCount`,`ordPrice`,`ordDiscount`, `ordDelivery`,`savePoint`, 
                                        `usedPoint`, `ordTotPrice`, `recipName`, `recipHp`, `recipZip`, `recipAddr1`, 
                                        `recipAddr2`, `ordPayment`, `ordComplete`, `ordStatus`)
        values (#{ordUid},#{ordCount},#{ordPrice},#{ordDiscount},#{ordDelivery},#{savePoint}
               ,#{usedPoint},#{ordTotPrice},#{recipName},#{recipHp},#{recipZip},#{recipAddr1}
               ,#{recipAddr2},#{ordPayment},#{ordComplete},#{ordStatus})

    </insert>
    
    
    <insert id="insertOrderItem">
        

    </insert>
    
    
    <insert id="insertmPoint">
        

    </insert>
    
    
    
</mapper>